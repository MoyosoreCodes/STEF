<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title><%=user.first_name%> || Activity Log</title>
    <link rel="stylesheet" href="/User/assets/bootstrap/css/bootstrap.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="/User/assets/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="/User/assets/css/Footer-Dark.css">
    <link rel="stylesheet" href="/User/assets/css/styles.css">
    <link rel="stylesheet" href="/User/assets/css/trelyco-login-vertical-horizontal-1.css">
    <link rel="stylesheet" href="/User/assets/css/trelyco-login-vertical-horizontal.css">
</head>

<body style="padding-top: 8px;padding-left: 0px;background: url(&quot;/User/assets/img/Wallpapers%201366x768.jpg&quot;) no-repeat;background-size: cover;">
    <nav class="navbar navbar-light navbar-expand bg-white shadow mb-4 topbar static-top">
        <div class="container-fluid"><a class="navbar-brand" href="/" style="font-size: 24px;"><strong>C</strong>ovenant <strong>U</strong>niversity <strong>C</strong>ounselling <strong>C</strong>enter</a><button class="btn btn-link d-md-none rounded-circle me-3" id="sidebarToggleTop-1" type="button"><i class="fas fa-bars"></i></button>
            <form class="d-none d-sm-inline-block me-auto ms-md-3 my-2 my-md-0 mw-100 navbar-search">
                <div class="input-group"></div>
            </form>
            <ul class="navbar-nav flex-nowrap ms-auto">
                <li class="nav-item dropdown d-sm-none no-arrow"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#"><i class="fas fa-search"></i></a>
                    <div class="dropdown-menu dropdown-menu-end p-3 animated--grow-in" aria-labelledby="searchDropdown">
                        <form class="me-auto navbar-search w-100">
                            <div class="input-group"><input class="bg-light form-control border-0 small" type="text" placeholder="Search for ...">
                                <div class="input-group-append"><button class="btn btn-primary py-0" type="button"><i class="fas fa-search"></i></button></div>
                            </div>
                        </form>
                    </div>
                </li>
                <li class="nav-item dropdown no-arrow mx-1">
                    <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#"><span class="badge bg-danger badge-counter"><%=appointments.length%></span><i class="fas fa-bell fa-fw"></i></a>
                        <div class="dropdown-menu dropdown-menu-end dropdown-list animated--grow-in" style="width: 422.6px;">
                            <% if(appointments.length > 0) { %>
                                <h6 class="dropdown-header">Notifications</h6>
                                <% for(var appointment of appointments) { %>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="me-3">
                                        <div class="bg-primary icon-circle"><i class="fas fa-file-alt text-white"></i></div>
                                    </div>
                                    <div style="width: 293.6px;"><span class="small text-gray-500"><%= appointment.appointmentDate %></span>
                                        <p style="width: 339.6px;text-align: center;max-width: none;margin-right: 0px;min-width: none;">Session is <%= appointment.status %></p>
                                    </div>
                                </a>
                                <!-- <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="me-3">
                                        <div class="bg-success icon-circle"><i class="fas fa-file-alt text-white"></i></div>
                                    </div>
                                    <div><span class="small text-gray-500"><%= appointment.appointmentDate %></span>
                                        <p>Session is <%= appointment.status %></p>
                                    </div>
                                </a><a class="dropdown- item d-flex align-items-center" href="#">
                                    <div class="me-3">
                                        <div class="bg-warning icon-circle"><i class="fas fa-exclamation-triangle text-white"></i></div>
                                    </div>
                                    <div><span class="small text-gray-500">July 15, 2021</span>
                                        <p>Alert!: You have an upcoming session in 30 days.</p>
                                    </div> -->
                                </a><a class="dropdown-item text-center small text-gray-500" href="#">Show All Alerts</a>
                                <% } %>
                            <% } else { %>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="me-3">
                                        <div class="bg-primary icon-circle"><i class="fas fa-file-alt text-white"></i></div>
                                    </div>
                                    <div style="width: 293.6px;"><span class="small text-gray-500"></span>
                                        <p style="width: 339.6px;text-align: center;max-width: none;margin-right: 0px;min-width: none;">You have no pending sessions</p>
                                    </div>
                                </a>
                            <% } %>
                        </div>                             
                    </div>
                </li>
                <div class="d-none d-sm-block topbar-divider"></div>
                <li class="nav-item dropdown no-arrow">
                    <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#"><span class="d-none d-lg-inline me-2 text-gray-600 small"><%=user.email%></span><img class="border rounded-circle img-profile" src="/User/assets/img/Gojou.jpg" style="width: 46px;"></a>
                        <div class="dropdown-menu shadow dropdown-menu-end animated--grow-in"><a class="dropdown-item" href="/dashboard/patient"><i class="fas fa-user fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Profile</a><a class="dropdown-item" href="#tab-4"><i class="fas fa-cogs fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Settings</a><a class="dropdown-item" href="#tab-1"><i class="fas fa-list fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Activity log</a>
                            <div class="dropdown-divider"></div><a class="dropdown-item" href="/logout"><i class="fas fa-sign-out-alt fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Logout</a>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
    <div class="col-lg-12 d-lg-flex justify-content-lg-center" style="height: 600px;margin-top: 10px;">
        <div class="card shadow mb-3" style="width: 1270px;height: 590px;margin-bottom: 60px;">
            <div class="card-body">
                <!-- <form style="width: 1250px;height: 206px;padding: 41px 41px;padding-top: 0px;padding-right: 94px;padding-bottom: 16px;"> -->
                    <div class="container">
                        <div class="row" style="width: 1092px;margin-right: 0px;">
                            <div class="col-md-3">
                                <div style="width: 25px;"><img src="/User/assets/img/Gojou.jpg" style="width: 155px;height: 162.1px;"></div>
                            </div>
                            <div class="col-md-7" style="padding-bottom: 25px;height: 100px;width: 811px;">
                                <div></div>
                                <h5>Name: <%=user.first_name%> <%=user.last_name%></h5>
                                <h6 style="font-weight: bold;">Location: <%=user.Location%></h6>
                                <p>ID:&nbsp;<span style="font-weight: bold;"><%=user.patientId%></span></p>
                                <div style="height: 403px;width: 810px;">
                                    <ul class="nav nav-tabs" role="tablist" style="width: 568px;">
                                        <li class="nav-item" role="presentation"><a class="nav-link" role="tab" data-bs-toggle="tab" href="#tab-1">Sessions&nbsp;</a></li>
                                        <li class="nav-item" role="presentation"><a class="nav-link active" role="tab" data-bs-toggle="tab" href="#tab-3">Appointment</a></li>
                                        <li class="nav-item" role="presentation"><a class="nav-link" role="tab" data-bs-toggle="tab" href="#tab-4">Settings</a></li>
                                    </ul>
                                    <div class="tab-content">
                                        <div class="tab-pane" role="tabpanel" id="tab-1">
                                            <div class="table-responsive shadow" style="padding-top: 0px;width: 653px;height: 383px;padding-left: 18px;padding-right: 0px;text-align: center;">
                                                    <% if(appointments.length > 0) { %>
                                                        <table class="table table-hover table-borderless">
                                                            <thead>
                                                                <tr style="height: 60px;padding-left: 20px;">
                                                                    <th>Date</th>
                                                                    <th>Time</th>
                                                                    <th>Status</th>
                                                                </tr>
                                                            </thead>
                                                        <% for(var appointment of appointments) { %>
                                                            <tbody>
                                                                <tr style="height: 60px;">
                                                                    <td style="text-align: center;"><%= appointment.appointmentDate %></td>
                                                                    <td style="text-align: center;"><%= appointment.appointmentTime %></td>
                                                                    <td><%= appointment.status %></td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <% } %>
                                                    <% } else { %>
                                                        <p> You currently have no sessions with the counsellor </p>
                                                    <% } %>
                                                    
                                                    <!--<tr style="height: 60px;">
                                                            <td style="text-align: center;">02/02/2021</td>
                                                            <td>12 : 00 pm</td>
                                                            <td>Completed</td>
                                                        </tr>
                                                        <tr style="height: 60px;">
                                                            <td style="text-align: center;">16/03/2021</td>
                                                            <td>11 : 30 am</td>
                                                            <td>Completed</td>
                                                        </tr>
                                                        <tr style="height: 60px;">
                                                            <td style="text-align: center;">09/04/2021</td>
                                                            <td>15 : 30 pm</td>
                                                            <td>Completed</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="height: 60px;text-align: center;">28/05/2021</td>
                                                            <td>15 : 00 pm</td>
                                                            <td>Completed</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="height: 60px;text-align: center;">10/07/2021</td>
                                                            <td>13 : 00 pm</td>
                                                            <td>Completed</td>
                                                        </tr>
                                                        <tr>
                                                            <td style="height: 60px;text-align: center;">15/08/2021</td>
                                                            <td>14 : 00 pm</td>
                                                            <td style="font-weight: bold;">Pending</td>
                                                        </tr> -->
                                            </div>
                                        </div>
                                        <div class="tab-pane active" role="tabpanel" id="tab-3" style="padding-top: 0px;padding-left: 42px;">
                                            <div class="card shadow mb-3" style="width: 500px;height: 434px;">
                                                <div class="card-header py-3" style="padding-bottom: 10px;height: 52px;">
                                                    <p class="m-0 fw-bold" style="font-size: 18px;">Book an appointment</p>
                                                </div>
                                                <div class="card-body" style="height: 267px;padding-bottom: 4px;min-height: none;">
                                                    <form id="appointmentForm" style="padding-left: 27px;padding-top: 0px;height: 301px;">
                                                        <label class="form-label" style="font-size: 18px;">Date of appointment:</label>
                                                        <input class="form-control" required type="date" name="appointmentDate" id="appointmentDate">
                                                        <label class="form-label" style="font-size: 18px;">Time of appointment:</label>
                                                        <input class="form-control" required type="text" name="appointmentTime" id="appointmentTime" placeholder="00:00" style="background: rgba(255,255,255,0);border-style: solid;">
                                                        <label class="form-label" style="font-size: 18px;">Area for counselling:</label>
                                                        <select class="form-select" required name="couselling_type" id="couselling_type">
                                                            <optgroup label="Counselling areas">
                                                                <option value="" selected="">~~Select here~~</option>
                                                                <option value="Academic">Academic</option>
                                                                <option value="Work Problems">Work Problems</option>
                                                                <option value="Study Skill">Study Skill</option>
                                                                <option value="Adjustment">Adjustment</option>
                                                                <option value="Relationship">Relationship</option>
                                                                <option value="Work Problems">Work Problems</option>
                                                                <option value="Career Options">Career Options</option>
                                                                <option value="PTSD">PTSD</option>
                                                                <option value="Addiction">Addiction</option>
                                                                <option value="Substance Related">Substance Related</option>
                                                                <option value="Childhood/Family issues">Childhood/Family issues</option>
                                                                <option value="Dreams">Dreams</option>
                                                                <option value="Parenting">Parenting</option>
                                                                <option value="Finances">Finances</option>
                                                                <option value="Others">Others</option>
                                                            </optgroup>
                                                        </select><label class="form-label" style="font-size: 18px;margin-top: 16px;">If others please specify:</label><input class="form-control" type="text" style="background: rgba(255,255,255,0);height: 27px;border-style: double;border-top-style: none;border-right-style: none;border-bottom-style: inset;border-left-width: 28px;border-left-style: none;">
                                                    </form>
                                                    <div style="padding-top: 15px;padding-left: 119px;"><input class="btn btn-primary d-grid" type="submit" style="background: var(--bs-indigo);padding-top: 6px;padding-left: 15px;" value="Submit" onsubmit=makeAppointment()/></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane" role="tabpanel" id="tab-4">
                                            <div class="col-lg-12 d-lg-flex justify-content-lg-center" style="padding-top: 8px;width: 500px;">
                                                <div class="card shadow mb-3" style="width: 500px;">
                                                    <div class="card-header py-3" style="padding-bottom: 10px;height: 52px;">
                                                        <p class="m-0 fw-bold" style="font-size: 18px;">Change Password</p>
                                                    </div>
                                                    <div class="card-body" style="height: 267px;padding-bottom: 4px;min-height: none;">
                                                        <form>
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="form-group mb-3"><label class="form-label" for="first_name"><strong>New Password</strong><br></label><input class="form-control" type="password"></div>
                                                                </div>
                                                                <div class="col">
                                                                    <div class="form-group mb-3"><label class="form-label" for="first_name"><strong>Confirm New Password</strong><br></label><input class="form-control" type="password"></div>
                                                                </div>
                                                            </div>
                                                            <div class="form-group mb-3"><button class="btn btn-primary btn-sm" type="submit" style="background: var(--bs-indigo);">Save Changes</button></div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                <!-- </form> -->
                <div class="col" style="height: 317px;width: 341px;padding-top: 0px;padding-right: 0px;padding-left: 0px;">
                    <p style="width: 323px;font-weight: bold;"><%= user.bio %></p>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer-dark" style="margin-right: 0px;">
        <div class="container">
            <div class="row">
                <div class="col-sm-6 col-md-3 item">
                    <h3>Pages</h3>
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/dashboard/patient">Profile</a></li>
                        <li><a href="/dashboard/activity-log">Appoinment</a></li>
                    </ul>
                </div>
                <div class="col-sm-6 col-md-3 item">
                    <h3>About</h3>
                    <ul>
                        <li><a href="/">CUCC</a></li>
                        <li><a href="/">Vision &amp; Mission</a></li>
                        <li></li>
                    </ul>
                </div>
                <div class="col-md-6 item text">
                    <h3>Covenant University Counselling Center</h3>
                    <p>Covenant University Counselling Center (CUCC) is an open door away. We exist because of you...</p>
                    <p style="font-weight: bold;font-size: 18px;">B302, CMSS Building (formerly known as CBSS), covenant university</p>
                    <p style="font-weight: bold;"></p>
                </div>
            </div>
            <p class="copyright">Otani © 2021</p>
        </div>
    </footer>
    <script src="/User/assets/bootstrap/js/bootstrap.min.js"></script>
    <script>
        window.watsonAssistantChatOptions = {
            integrationID: "04529ddf-1333-450c-b422-a7a2a1f27123", // The ID of this integration.
            region: "eu-gb", // The region your integration is hosted in.
            serviceInstanceID: "99f34a30-556a-4594-9182-51e6d34bfe2f", // The ID of your service instance.
            onLoad: function(instance) { instance.render(); }
          };
        setTimeout(function(){
          const t=document.createElement('script');
          t.src="https://web-chat.global.assistant.watson.appdomain.cloud/loadWatsonAssistantChat.js";
          document.head.appendChild(t);
        });
      </script>
      <script>
        function makeAppointment(){
            event.preventDefault();
            console.log('it works');
            const appointmentDate = document.getElementById('appointmentDate').value;
            const appointmentTime = document.getElementById('appointmentTime').value;
            const couselling_type = document.getElementById('couselling_type').value;

            console.log(appointmentDate);
            console.log(appointmentTime);
            console.log(couselling_type);
            const formData = {
                appointmentDate,
                appointmentTime,
                couselling_type
            }

            fetch('https://stef-dev.herokuapp.com/appointments/create', {
                method: 'POST', 
                headers: { 
                    'Content-Type': 'application/json' 
                    // 'Content-Type': 'application/x-www-form-urlencoded', 
                }, 
                body: JSON.stringify(formData)
            }).then(data => {
                console.log(data);
                console.log('appointment created successfully');
                alert('appointment created successfully')
            }).catch(err => {
                console.log(err);
            })
        }
    </script>
</body>

</html>